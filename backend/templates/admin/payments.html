<script>
  const token = localStorage.getItem("access");

  if (!token) {
    window.location.href = "/login/";
  }
</script>
<nav>
  <a href="/admin/dashboard/"><button>Admin Dashboard</button></a>
  <a href="/admin/products/"><button>Manage Products</button></a>
  <a href="/admin/orders/"><button >Manage Orders</button></a>
  <a href="/login/" onclick="localStorage.clear()"><button>Logout</button></a>
</nav>
<div id="admin-content"></div>

<h2>Payments</h2>
<ul id="paymentsList"></ul>

<script>
{% comment %} const token = localStorage.getItem("access"); {% endcomment %}
  const paymentsList = document.getElementById("paymentsList");

  fetch("/api/payments/all/", {
    headers: {"Authorization": "Bearer " + token}
  })
    .then(res => res.json())
    .then(data => {
      paymentsList.innerHTML = "";
      data.forEach(p => {
        paymentsList.innerHTML += `
      <li>
        ${p.provider} |
        Txn: ${p.session_id} |
        Amount: ${p.amount} |
        Status: ${p.status}
      </li>`;
      });
    });
</script>
